<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "ball-atom" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
<mat-card *ngIf="editMode" class="cardWithShadow">
  <mat-card-content class="p-24">
    <mat-card-title class=" b-b-1">
      <div class="row">
        <div class="col-8 col-md-6 title"> 
          <h3 *ngIf="newUser">Add User</h3>
          <h3 *ngIf="!newUser">Manage User</h3>
        </div>
        <div class="col-4 col-md-6 align-end btn-group">
            <button mat-raised-button color="primary" 
              class="m-t-12 m-b-12 m-r-3" 
              [disabled]="!userForm?.valid"
              (click)="addUser()">Save</button>
          <button mat-raised-button  color="warn" class="m-t-12 m-b-12" (click)="cancelEditUser()">Cancel</button>
        </div>
      </div>
    </mat-card-title>

  
    <form [formGroup]="userForm"> 
      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">User Details</h4>
        </div> 

        <div class="col-md-2">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Title</mat-label>
            <select matNativeControl required formControlName="title">
              <option *ngFor="let val of titles" value="{{val}}">{{val}}</option> 
            </select>
          </mat-form-field>
        </div> 

        <div class="col-md-4">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>First Name</mat-label>
            <input matInput type="text" formControlName="firstName">
            <mat-hint class="error" *ngIf="userForm?.get('firstName')?.invalid && userForm?.get('firstName')?.touched">
              *First name is required
            </mat-hint>
          </mat-form-field>
        </div> 

        <div class="col-md-3">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Last Name</mat-label>
            <input matInput type="text" formControlName="lastName">
            <mat-hint class="error" *ngIf="userForm?.get('lastName')?.invalid && userForm?.get('lastName')?.touched">
              *Last name is required
            </mat-hint>
          </mat-form-field>
        </div> 
      </div>

      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">Gender / ID Number</h4>
        </div>

        <div class="col-md-3">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Gender</mat-label>
            <select matNativeControl required formControlName="gender">
              <option *ngFor="let val of genders" value="{{val}}">{{val}}</option> 
            </select>
            <mat-hint class="error" *ngIf="userForm?.get('gender')?.invalid && userForm?.get('gender')?.touched">
              *Gender is required
            </mat-hint>
          </mat-form-field> 
        </div>

        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>ID Number</mat-label>
            <input matInput type="text" formControlName="idNo">
            <mat-hint class="error" *ngIf="userForm?.get('idNo')?.invalid && userForm?.get('idNo')?.touched">
              *ID number is required
            </mat-hint>
          </mat-form-field>
        </div>
      </div>

      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">Role</h4>
        </div>

        <div class="col-md-9">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>User Role</mat-label>
            <select matNativeControl required formControlName="role">
              <option *ngFor="let val of roles" value="{{val}}">{{val}}</option> 
            </select>
            <mat-hint class="error" *ngIf="userForm?.get('role')?.invalid && userForm?.get('role')?.touched">
              *User role is required
            </mat-hint>
          </mat-form-field>
        </div>
      </div>


      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">Email Address</h4>
        </div>

        <div class="col-md-9">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Email Address</mat-label>
            <input matInput type="email" formControlName="email">
            <mat-hint class="error" *ngIf="userForm?.get('email')?.invalid && userForm?.get('email')?.touched">
              *Email address is required
            </mat-hint>
          </mat-form-field>
        </div>
      </div>

      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">Phone Number</h4>
        </div>

        <div class="col-md-9">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Phone Number</mat-label>
            <input matInput type="text" formControlName="phone">
            <mat-hint class="error" *ngIf="userForm?.get('phone')?.invalid && userForm?.get('phone')?.touched">
              *Phone number is required
            </mat-hint>
          </mat-form-field>
        </div>
      </div>

      <div class="row m-t-12">
        <div class="col-md-3">
          <h4 class="w-100">Residenatial Address</h4>
        </div>

        <div class="col-md-9">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Physical Address</mat-label>
            <textarea matInput rows="5" formControlName="physicalAddress"></textarea>
            <mat-hint class="error" *ngIf="userForm?.get('physicalAddress')?.invalid && userForm?.get('physicalAddress')?.touched">
              *Physcial address is required
            </mat-hint>
          </mat-form-field>
        </div>

 
      </div>


    </form>



  </mat-card-content>
</mat-card>


<mat-card *ngIf="!editMode" class="cardWithShadow">
  <mat-card-content class="p-24">
    <mat-card-title class=" b-b-1">
      <div class="row">
        <div class="col-md-9 col-sm-6 title"> <h3>Manage Users</h3></div>
        <div class="col-md-3 col-sm-6 align-end">
          <button mat-raised-button color="primary" class="m-t-12 m-b-12" (click)="addNewUser()">Add Customer</button>
        </div>
      </div>
    </mat-card-title>
    
    <div class="table-responsive m-t-16">
      <table mat-table [dataSource]="users" class="w-100">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
            Name
          </th>
          <td mat-cell *matCellDef="let element">
            <div class="d-flex align-items-center">
              <img
                src="assets/images/profile/user-1.jpg"
                alt="users"
                width="40"
                class="rounded-circle"
              />
              <div class="m-l-16">
                <h6 class="mat-subtitle-1 f-s-14 f-w-600">
                  {{ element.title }} {{ element.firstName }} {{ element.lastName }}
                </h6>
                <span class="mat-body-1 f-s-12">
                  {{ element.role }}
                </span>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Id Number Column -->
        <ng-container matColumnDef="idNo">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
            Id Number
          </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            {{ element.idNo }}
          </td>
        </ng-container>

        <!-- Gender Column -->
        <ng-container matColumnDef="gender">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
          Gender
          </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            {{ element.gender }}
          </td> 
        </ng-container>

        <!--  Email Column -->
        <ng-container matColumnDef="email">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
            Email
          </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            {{ element.email }}
          </td>
        </ng-container>

          <!-- Phone Column -->
        <ng-container matColumnDef="phone">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
          Phone Number
          </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            {{ element.phone }}
          </td>
        </ng-container>

        <!--  Physical Address Column -->
        <ng-container matColumnDef="physicalAddress">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          >
          Address
          </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            {{ element.physicalAddress }}
          </td>
        </ng-container>

        <!-- Action Column -->
        <ng-container matColumnDef="actionButton">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="f-w-600 mat-subtitle-1 f-s-14"
          > </th>
          <td mat-cell *matCellDef="let element" class="mat-body-1">
            <button color="primary" (click)="editUserDetails(element)" mat-mini-fab>
              <mat-icon>edit_square</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </mat-card-content>
</mat-card>



 